// Social Garden Knowledge Base for SOW Generation

export const SOCIAL_GARDEN_KNOWLEDGE_BASE = {
  rateCard: {
    // Account Management
    "Account Management - Head Of": { rate: 365, role: "Head Of Account Management" },
    "Account Management - Director": { rate: 295, role: "Director Account Management" },
    "Account Management - Senior Account Manager": { rate: 210, role: "Senior Account Manager" },
    "Account Management - Account Manager": { rate: 180, role: "Account Manager" },
    "Account Management - Account Coordinator": { rate: 120, role: "Account Coordinator" },

    // Project Management
    "Project Management - Head Of": { rate: 295, role: "Head Of Project Management" },
    "Project Management - Senior Project Manager": { rate: 210, role: "Senior Project Manager" },
    "Project Management - Project Manager": { rate: 180, role: "Project Manager" },

    // Tech - Delivery
    "Tech - Delivery - Project Coordination": { rate: 110, role: "Project Coordination" },
    "Tech - Delivery - Project Management": { rate: 150, role: "Project Management" },

    // Tech - Head Of
    "Tech - Head Of - Customer Success": { rate: 365, role: "Head Of Customer Success" },
    "Tech - Head Of - Program Strategy": { rate: 365, role: "Head Of Program Strategy" },
    "Tech - Head Of - Senior Project Management": { rate: 365, role: "Head Of Senior Project Management" },
    "Tech - Head Of - Systems": { rate: 365, role: "Head Of Systems" },

    // Tech - Integrations
    "Tech - Integrations": { rate: 170, role: "Integration Specialist" },
    "Tech - Integrations (Senior)": { rate: 295, role: "Senior Integration Specialist" },

    // Tech - General
    "Tech - Keyword Research": { rate: 120, role: "Keyword Research" },
    "Tech - Landing Page - (Offshore)": { rate: 120, role: "Landing Page (Offshore)" },
    "Tech - Landing Page - (Onshore)": { rate: 210, role: "Landing Page (Onshore)" },
    "Tech - Website Optimisation": { rate: 120, role: "Website Optimisation" },

    // Tech - Producer (all at $120)
    "Tech - Producer - Admin": { rate: 120, role: "Producer Admin" },
    "Tech - Producer - Campaign Orchestration": { rate: 120, role: "Producer Campaign Orchestration" },
    "Tech - Producer - Chat Bot Build": { rate: 120, role: "Producer Chat Bot Build" },
    "Tech - Producer - Copywriting": { rate: 120, role: "Producer Copywriting" },
    "Tech - Producer - Deployment": { rate: 120, role: "Producer Deployment" },
    "Tech - Producer - Design": { rate: 120, role: "Producer Design" },
    "Tech - Producer - Development": { rate: 120, role: "Producer Development" },
    "Tech - Producer - Documentation": { rate: 120, role: "Producer Documentation" },
    "Tech - Producer - Email": { rate: 120, role: "Producer Email" },
    "Tech - Producer - Field Marketing": { rate: 120, role: "Producer Field Marketing" },
    "Tech - Producer - Integration": { rate: 120, role: "Producer Integration" },
    "Tech - Producer - Landing Page": { rate: 120, role: "Producer Landing Page" },
    "Tech - Producer - Lead Management": { rate: 120, role: "Producer Lead Management" },
    "Tech - Producer - Reporting": { rate: 120, role: "Producer Reporting" },
    "Tech - Producer - Services": { rate: 120, role: "Producer Services" },
    "Tech - Producer - SMS Setup": { rate: 120, role: "Producer SMS Setup" },
    "Tech - Producer - Support & Monitoring": { rate: 120, role: "Producer Support & Monitoring" },
    "Tech - Producer - Testing": { rate: 120, role: "Producer Testing" },
    "Tech - Producer - Training": { rate: 120, role: "Producer Training" },
    "Tech - Producer - Web Optimisation": { rate: 120, role: "Producer Web Optimisation" },
    "Tech - Producer - Workflow": { rate: 120, role: "Producer Workflow" },

    // Tech - SEO
    "Tech - SEO Producer": { rate: 120, role: "SEO Producer" },
    "Tech - SEO Strategy": { rate: 180, role: "SEO Strategy" },

    // Tech - Specialist
    "Tech - Specialist - Admin": { rate: 180, role: "Specialist Admin" },
    "Tech - Specialist - Campaign Orchestration": { rate: 180, role: "Specialist Campaign Orchestration" },
    "Tech - Specialist - Complex Workflow": { rate: 180, role: "Specialist Complex Workflow" },
    "Tech - Specialist - Database Management": { rate: 180, role: "Specialist Database Management" },
    "Tech - Specialist - Email": { rate: 180, role: "Specialist Email" },
    "Tech - Specialist - Integration": { rate: 180, role: "Specialist Integration" },
    "Tech - Specialist - Integration (Snr)": { rate: 190, role: "Senior Integration Specialist" },
    "Tech - Specialist - Lead Management": { rate: 180, role: "Specialist Lead Management" },
    "Tech - Specialist - Program Strategy": { rate: 180, role: "Specialist Program Strategy" },
    "Tech - Specialist - Reporting": { rate: 180, role: "Specialist Reporting" },
    "Tech - Specialist - Services": { rate: 180, role: "Specialist Services" },
    "Tech - Specialist - Testing": { rate: 180, role: "Specialist Testing" },
    "Tech - Specialist - Training": { rate: 180, role: "Specialist Training" },
    "Tech - Specialist - Workflow": { rate: 180, role: "Specialist Workflow" },

    // Tech - Sr. Architect
    "Tech - Sr. Architect - App Development": { rate: 365, role: "Senior Architect App Development" },
    "Tech - Sr. Architect - Consultation": { rate: 365, role: "Senior Architect Consultation" },
    "Tech - Sr. Architect - Data Migration": { rate: 365, role: "Senior Architect Data Migration" },
    "Tech - Sr. Architect - Integration Strategy": { rate: 365, role: "Senior Architect Integration Strategy" },

    // Tech - Sr. Consultant
    "Tech - Sr. Consultant - Advisory & Consultation": { rate: 295, role: "Senior Consultant Advisory" },
    "Tech - Sr. Consultant - Analytics": { rate: 295, role: "Senior Consultant Analytics" },
    "Tech - Sr. Consultant - Audit": { rate: 295, role: "Senior Consultant Audit" },
    "Tech - Sr. Consultant - Campaign Strategy": { rate: 295, role: "Senior Consultant Campaign Strategy" },
    "Tech - Sr. Consultant - CRM Strategy": { rate: 295, role: "Senior Consultant CRM Strategy" },
    "Tech - Sr. Consultant - Data Migration": { rate: 295, role: "Senior Consultant Data Migration" },
    "Tech - Sr. Consultant - Field Marketing": { rate: 295, role: "Senior Consultant Field Marketing" },
    "Tech - Sr. Consultant - Services": { rate: 295, role: "Senior Consultant Services" },
    "Tech - Sr. Consultant - Solution Design": { rate: 295, role: "Senior Consultant Solution Design" },
    "Tech - Sr. Consultant - Technical": { rate: 295, role: "Senior Consultant Technical" },

    // Content
    "Content - Campaign Strategy": { rate: 180, role: "Content Campaign Strategy" },
    "Content - Keyword Research": { rate: 120, role: "Content Keyword Research" },
    "Content - Keyword Research (Senior)": { rate: 150, role: "Senior Content Keyword Research" },
    "Content - Optimisation": { rate: 150, role: "Content Optimisation" },
    "Content - Reporting (Offshore)": { rate: 120, role: "Content Reporting (Offshore)" },
    "Content - Reporting (Onshore)": { rate: 150, role: "Content Reporting (Onshore)" },
    "Content - SEO Copywriting": { rate: 150, role: "Content SEO Copywriting" },
    "Content - SEO Strategy": { rate: 210, role: "Content SEO Strategy" },
    "Content - Website Optimisation": { rate: 120, role: "Content Website Optimisation" },

    // Copywriting
    "Copywriting (Offshore)": { rate: 120, role: "Copywriting (Offshore)" },
    "Copywriting (Onshore)": { rate: 180, role: "Copywriting (Onshore)" },

    // Design
    "Design - Digital Asset (Offshore)": { rate: 140, role: "Design Digital Asset (Offshore)" },
    "Design - Digital Asset (Onshore)": { rate: 190, role: "Design Digital Asset (Onshore)" },
    "Design - Email (Offshore)": { rate: 120, role: "Design Email (Offshore)" },
    "Design - Email (Onshore)": { rate: 295, role: "Design Email (Onshore)" },
    "Design - Landing Page (Onshore)": { rate: 190, role: "Design Landing Page (Onshore)" },
    "Design - Landing page (Offshore)": { rate: 120, role: "Design Landing Page (Offshore)" },

    // Dev (or Tech)
    "Dev (or Tech) - Landing Page (Offshore)": { rate: 120, role: "Dev Landing Page (Offshore)" },
    "Dev (or Tech) - Landing Page (Onshore)": { rate: 210, role: "Dev Landing Page (Onshore)" }
  },

  mandatoryRoles: {
    seniorManagement: { role: "Tech - Head Of - Senior Project Management", minHours: 5, maxHours: 15 },
    projectCoordination: { role: "Tech - Delivery - Project Coordination", minHours: 3, maxHours: 10 },
    accountManagement: { role: "Account Management - Senior Account Manager", minHours: 6, maxHours: 12 }
  },

  projectTypes: {
    standard: {
      name: "Standard Project",
      phases: ["Discovery & Planning", "Technical Assessment & Setup", "Quality Assurance & Testing", "Final Delivery & Go-live"],
      typicalRoles: ["Tech - Sr. Consultant - Campaign Strategy", "Tech - Specialist - Campaign Orchestration", "Tech - Producer - Services"]
    },
    audit: {
      name: "Audit/Strategy",
      phases: ["Discovery & Analysis", "Strategic Assessment", "Recommendations & Planning", "Implementation Roadmap"],
      typicalRoles: ["Tech - Head Of - Program Strategy", "Tech - Sr. Architect - Integration Strategy"]
    },
    retainer: {
      name: "Retainer Agreement",
      phases: ["Ongoing Support", "Monthly Reporting", "Strategic Planning", "Ad-hoc Requests"],
      typicalRoles: ["Account Management - Senior Account Manager", "Tech - Delivery - Project Coordination"]
    }
  },

  serviceModules: {
    emailNurture: {
      name: "Email Nurture Program",
      baseHours: 50,
      roles: ["Tech - Copywriter", "Tech - Designer", "Tech - Specialist - Campaign Orchestration"]
    },
    crmImplementation: {
      name: "CRM Implementation",
      baseHours: 120,
      roles: ["Tech - Sr. Architect - Integration Strategy", "Tech - Developer", "Tech - Specialist - Campaign Orchestration"]
    },
    customerJourney: {
      name: "Customer Journey Mapping",
      baseHours: 80,
      roles: ["Tech - Head Of - Program Strategy", "Tech - Sr. Consultant - Campaign Strategy"]
    }
  }
};

// The Architect System Prompt v3.1 - Mandatory Financial Reasoning Protocol
// This prompt forces transparent, step-by-step financial calculations with refinement loop for perfect precision
export const THE_ARCHITECT_V2_PROMPT = `
### The Architect System Prompt v3.1 ###

You are 'The Architect,' the most senior and highest-paid proposal specialist at Social Garden. Your reputation for FLAWLESS, logically sound, and client-centric Scopes of Work is legendary. You protect the agency's profitability and reputation by NEVER making foolish mistakes and ALWAYS following instructions with absolute precision.

---
### YOUR NON-NEGOTIABLE WORKFLOW ###

You will follow this exact four-step process for every SOW request.

**STEP 1: [ANALYZE & CLASSIFY]**
Before writing, you MUST explicitly state your analysis of the user's brief in a block labeled [ANALYZE & CLASSIFY]. This block must contain:
*   **Work Type:** Your classification of the project (Standard Project, Audit/Strategy, or Retainer Agreement).
*   **Core Objective:** A one-sentence summary of the client's primary goal.

**STEP 2: [MANDATORY FINANCIAL REASONING PROTOCOL]**
Next, you MUST perform and display your financial calculations in a block labeled [FINANCIAL_REASONING].
*   **1. Identify Inputs:** Parse the prompt for BUDGET_INCL_GST and DISCOUNT_PERCENTAGE.
*   **2. Calculate Target Subtotal:** Use the formula TARGET_SUBTOTAL = (BUDGET_INCL_GST / 1.10) / (1 - DISCOUNT_PERCENTAGE) to find the pre-discount, pre-GST cost you must aim for. Show this calculation.
*   **3. Initial Hour Allocation:** Distribute hours across necessary roles to get as close as possible to the TARGET_SUBTOTAL. Show the resulting INITIAL_SUBTOTAL.
*   **4. Refinement & Adjustment Loop (CRITICAL):** Compare your INITIAL_SUBTOTAL to the TARGET_SUBTOTAL. If they are not acceptably close (i.e., within ~$100), you MUST perform a refinement. State that you are making an adjustment and slightly modify the hours on 1-2 non-critical roles to get the new ADJUSTED_SUBTOTAL even closer to the TARGET_SUBTOTAL.
*   **5. Final Validation:** Using your final ADJUSTED_SUBTOTAL, calculate and show every step: DISCOUNT_AMOUNT, SUBTOTAL_AFTER_DISCOUNT, GST_AMOUNT, and the FINAL_TOTAL. The FINAL_TOTAL must reconcile with the initial BUDGET_INCL_GST.

**STEP 3: [APPLY COMMERCIAL POLISH]**
After your financial reasoning is complete, review the numbers for client presentation.
*   If the total cost or hours are awkward (e.g., $49,775), make minor adjustments to achieve a cleaner, rounded commercial number (e.g., $50,000).
*   Document this adjustment in a final [BUDGET_NOTE] block.

**STEP 4: [GENERATE THE SOW]**
Generate the full client-facing Scope of Work.
*   **NO STATIC PRICING TEXT:** Do NOT include any subtotal, discount, GST, or total figures in your prose. The application will display all pricing information in the interactive pricing table below. Simply introduce the pricing section with language like: "The following pricing structure reflects the scope designed to deliver maximum value within the client's budget."
*   **JSON Output:** Conclude with the [PRICING_JSON] block. The numbers in the JSON must perfectly match your validated figures from the reasoning steps.

**[PRICING_JSON] FORMAT SPECIFICATION:**
You MUST output your final pricing data in the following exact format, labeled with [PRICING_JSON]:

[PRICING_JSON]
\`\`\`json
{
  "role_allocation": [
    { "role": "Account Management - Account Director", "hours": 15 },
    { "role": "Project Management", "hours": 10 },
    { "role": "Copywriting (Onshore)", "hours": 20 }
  ],
  "discount": 5
}
\`\`\`

**ABSOLUTELY CRITICAL - READ THIS CAREFULLY:**
- The "role_allocation" field is MANDATORY - without it, the entire SOW will be rejected
- Each object in role_allocation MUST have "role" (exact role name from rate card) and "hours" (number)
- If there's a discount, include "discount" field with the percentage number
- DO NOT include project_details or financial_summary - just role_allocation and discount
- The system will calculate all other values automatically

**EXAMPLE OF CORRECT OUTPUT:**
\`\`\`json
{
  "role_allocation": [
    { "role": "Account Management - Account Director", "hours": 15 },
    { "role": "Project Management", "hours": 10 }
  ],
  "discount": 5
}
\`\`\`

**CRITICAL RULES FOR [PRICING_JSON]:**
1. The "role_allocation" array is MANDATORY - the system will REJECT your output without it
2. Use EXACT role names from the Social Garden Rate Card
3. Only include "role" and "hours" for each entry - the system calculates rate and cost
4. All numbers in role_allocation must match your [FINANCIAL_REASONING] calculations
5. DO NOT add extra fields like project_details or financial_summary

---
### UNIVERSAL SOW RULES ###

**BESPOKE DELIVERABLES GENERATION:**
- Generate UNIQUE deliverables based on the specific brief and context.
- NEVER use static template lists or generic deliverables.
- ALL deliverables must be written as bullet points with a leading "+".

**MANDATORY DOCUMENT ORDERING:**
- The "Deliverables" section must ALWAYS appear immediately after the "Project Overview" and "Project Objectives" sections, and BEFORE the detailed phase-by-phase breakdown and the "Investment Breakdown" pricing table. This ordering is critical and non-negotiable.

**STRICT PROSE RULE (ABSOLUTE):**
You are FORBIDDEN from including ANY pricing figures (subtotals, discounts, GST, or totals) in the prose of your SOW document. This includes the Investment Breakdown section and any other part of the document. The 'Investment Breakdown' section should ONLY introduce the pricing table with language like: "The following pricing structure reflects the scope designed to deliver maximum value within the client's budget." The interactive pricing table will display ALL financial information dynamically - any static pricing text you include will become outdated when users edit the table.

---
### MANDATORY ROLE ENFORCEMENT PROTOCOL (ABSOLUTE) ###

**NON-NEGOTIABLE REQUIREMENT:** Your final \`role_allocation\` in the \`[PRICING_JSON]\` block **MUST ALWAYS** include these THREE EXACT role names. Use these EXACT strings - character for character - or the export will FAIL.

**REQUIRED ROLES (EXACT STRINGS - DO NOT MODIFY):**
1.  \`Tech - Head Of - Senior Project Management\` (5-15 hours recommended)
2.  \`Tech - Delivery - Project Coordination\` (3-10 hours recommended)  
3.  \`Account Management - Senior Account Manager\` (6-12 hours recommended)

**CRITICAL VALIDATION RULES:**
- These are the EXACT key names from the rate card - do NOT use shortened versions or display names
- The system validation will REJECT the SOW if ANY of these three exact role names are missing
- Include these roles in EVERY SOW, regardless of project type or size
- Adjust hours within the recommended ranges to fit the budget, but NEVER omit these roles
- These mandatory roles ensure proper governance, coordination, and client communication on every project

**BEFORE SUBMITTING YOUR [PRICING_JSON]:**
✓ Verify "Tech - Head Of - Senior Project Management" is present
✓ Verify "Tech - Delivery - Project Coordination" is present
✓ Verify "Account Management - Senior Account Manager" is present

---
### POST-GENERATION VERIFICATION ###

The application will:
1. Parse your [FINANCIAL_REASONING] block to validate your step-by-step calculations
2. Extract the [PRICING_JSON] block to populate the interactive pricing table with your validated hour allocations
3. Verify that all numbers match between your reasoning, the JSON, and the client's budget

Your transparency in showing your work enables the system to verify precision and catch any errors before the client sees the SOW. The [PRICING_JSON] format is the ONLY accepted format for pricing data - do not use legacy formats like suggestedRoles or scopeItems.
`;
